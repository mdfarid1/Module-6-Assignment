
-- Start products table create and data insert
SET SQL_MODE = "NO_AUTO_VALUE_ON_ZERO";
START TRANSACTION;
SET time_zone = "+00:00";
CREATE TABLE `products` (
  `PRODUCT_ID` varchar(10) NOT NULL,
  `NAME` varchar(50) NOT NULL,
  `CATEGORY_ID` int NOT NULL,
  `DESCRIPTION` varchar(250) NOT NULL,
  `PRICE` float NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=latin1;
INSERT INTO `products` (`PRODUCT_ID`, `NAME`, `CATEGORY_ID`, `DESCRIPTION`, `PRICE`) VALUES
('1', 'Apple', 1, 'faridTo retrieve the product name, quantity,', 200),
('2', 'Banana', 1, 'ariTo retrieve the product name, quantity,com', 240),
('3', 'Roti', 2, 'nahTo retrieve the product name, quantity,', 40),
('4', 'Mango', 1, 'jaTo retrieve the product name, quantity,', 500),
('5', 'T-shart', 3, 'mTo retrieve the product name, quantity,m', 543),
('6', 'Pant', 3, 'arafaTo retrieve the product name, quantity,om', 235),
('7', 'watch', 4, 'niloyTo retrieve the product name, quantity,', 765),
('8', 'Gold', 4, 'arifiTo retrieve the product name, quantity,', 134);

ALTER TABLE `products`
  ADD PRIMARY KEY (`PRODUCT_ID`);
COMMIT;
-- end products table create and data insert



-- Start order_items table create and data insert

SET SQL_MODE = "NO_AUTO_VALUE_ON_ZERO";
START TRANSACTION;
SET time_zone = "+00:00";

CREATE TABLE `order_items` (
  `ORDER_ITEM_ID` varchar(255) NOT NULL,
  `ORDER_ID` int NOT NULL,
  `PRODUCT_ID` int NOT NULL,
  `QUANTITY` float DEFAULT NULL,
  `UNIT_PRICE` float DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=latin1;

INSERT INTO `order_items` (`ORDER_ITEM_ID`, `ORDER_ID`, `PRODUCT_ID`, `QUANTITY`, `UNIT_PRICE`) VALUES
('1', 1, 1, 2, 50),
('2', 2, 2, 3, 34),
('3', 1, 3, 4, 87),
('4', 2, 4, 1, 23),
('5', 4, 5, 4, 85),
('6', 4, 6, 6, 63),
('7', 3, 7, 9, 24),
('8', 3, 8, 5, 97);

ALTER TABLE `order_items`
  ADD PRIMARY KEY (`ORDER_ITEM_ID`);
COMMIT;
-- end order_items table create and data insert




--Start categories table create and data insert

SET SQL_MODE = "NO_AUTO_VALUE_ON_ZERO";
START TRANSACTION;
SET time_zone = "+00:00";
CREATE TABLE `categories` (
  `CATEGORY_ID` int NOT NULL,
  `NAME` varchar(30) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=latin1;

INSERT INTO `categories` (`CATEGORY_ID`, `NAME`) VALUES
(1, 'fruits'),
(2, '	Sorkora'),
(3, 'cloths'),
(4, 'Julery');

ALTER TABLE `categories`
  ADD PRIMARY KEY (`CATEGORY_ID`);

ALTER TABLE `categories`
  MODIFY `CATEGORY_ID` int NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=22;
COMMIT;
--end categories table create and data insert


-- Task 03 :
-- Write a SQL query to retrieve the total revenue generated by each product category. Display the category name along with the total revenue in descending order of the revenue.

SELECT
    categories.NAME,
    SUM(products.price * order_items.quantity) AS total_revenue
FROM
    products 
INNER JOIN
    order_items ON products.product_id = order_items.product_id
INNER JOIN
    categories  ON products.category_id = categories.category_id
GROUP BY
    categories.NAME
ORDER BY
    total_revenue DESC;